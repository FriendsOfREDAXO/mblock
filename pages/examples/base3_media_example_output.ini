<?php

// üÜï MBlock 4.0 - Media-Ausgabe mit korrekten IDs

// Nur Online-Items laden
$items = MBlock::getOnlineDataArray("REX_VALUE[1]");

foreach ($items as $item) {
    echo '<div class="media-block">';
    
    // Einzelnes Medium (Media-ID 1)
    $mediaId = $item['REX_MEDIA_1'] ?? '';
    if ($mediaId) {
        $media = rex_media::get($mediaId);
        if ($media) {
            echo '<h4>Medium:</h4>';
            echo '<img src="' . rex_media_manager::getUrl('rex_media_medium', $media->getFileName()) . '" 
                       alt="' . rex_escape($media->getTitle()) . '" class="img-responsive" />';
        }
    }
    
    // Medialist (Media-ID 2) - WICHTIG: Andere ID als Single Media!
    $mediaListIds = $item['REX_MEDIALIST_2'] ?? '';
    if ($mediaListIds) {
        $mediaIds = explode(',', $mediaListIds);
        echo '<h4>Media List:</h4>';
        echo '<div class="media-gallery">';
        
        foreach ($mediaIds as $id) {
            $id = trim($id);
            if ($id) {
                $media = rex_media::get($id);
                if ($media) {
                    echo '<img src="' . rex_media_manager::getUrl('rex_media_small', $media->getFileName()) . '" 
                               alt="' . rex_escape($media->getTitle()) . '" style="margin: 5px;" />';
                }
            }
        }
        echo '</div>';
    }
    
    echo '</div><hr>';
}

// üîç Debug f√ºr Media-ID Probleme (bei Bedarf einkommentieren)
// echo '<h4>üêõ Debug: Media-IDs pr√ºfen</h4>';
// $allItems = MBlock::getDataArray("REX_VALUE[1]");
// foreach ($allItems as $index => $item) {
//     echo "<h5>Item $index:</h5>";
//     foreach ($item as $key => $value) {
//         if (strpos($key, 'REX_MEDIA') === 0) {
//             echo "- $key: $value<br>";
//         }
//     }
// }

?>