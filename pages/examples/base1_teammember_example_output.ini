<?php
use FriendsOfRedaxo\MBlock\MBlock;

// Nur Online-Items laden (empfohlen f√ºr Frontend)
$items = MBlock::getOnlineDataArray("REX_VALUE[1]");

foreach ($items as $item) {
    // Daten sicher extrahieren
    $name = rex_escape($item['name'] ?? '');
    $position = rex_escape($item['position'] ?? '');
    $email = rex_escape($item['email'] ?? '');
    $mediaId = $item['REX_MEDIA_1'] ?? ''; // Media-ID 1 verwenden!
    
    echo '<div class="team-member">';
    
    // Avatar anzeigen
    if ($mediaId) {
        $media = rex_media::get($mediaId);
        if ($media) {
            echo '<img src="' . rex_media_manager::getUrl('rex_media_medium', $media->getFileName()) . '" 
                       alt="' . rex_escape($media->getTitle()) . '" class="avatar img-responsive" />';
        }
    }
    
    // Informationen anzeigen
    if ($name) {
        echo '<h3>' . $name . '</h3>';
    }
    
    if ($position) {
        echo '<p class="position">' . $position . '</p>';
    }
    
    if ($email) {
        echo '<p class="email"><a href="mailto:' . $email . '">' . $email . '</a></p>';
    }
    
    echo '</div>';
}

// üîç Debug (nur w√§hrend Entwicklung einkommentieren)
// echo '<h4>Debug: Alle Items (inkl. Offline)</h4>';
// echo '<pre>';
// print_r(MBlock::getDataArray("REX_VALUE[1]"));
// echo '</pre>';

?>
